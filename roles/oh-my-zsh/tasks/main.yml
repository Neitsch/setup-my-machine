---
# tasks file for oh-my-zsh
- name: Clone oh-my-zsh
  git:
    repo: https://github.com/ohmyzsh/ohmyzsh
    dest: ~/.oh-my-zsh

- name: custom config
  blockinfile:
    block: |
      source $ZSH/oh-my-zsh.sh
    path: ~/.zshrc
    marker: "# {mark} source-oh-my-zsh"

- name: Clone autosuggestions
  git:
    repo: https://github.com/zsh-users/zsh-autosuggestions
    dest: ~/.oh-my-zsh/custom/plugins/zsh-autosuggestions

- name: Clone completions
  git:
    repo: https://github.com/zsh-users/zsh-completions
    dest: ~/.oh-my-zsh/custom/plugins/zsh-completions

- name: "Check if git is installed"
  command: dpkg-query -l git
  register: git_is_installed

- name: plugins
  vars:
    plugins:
      - "{{ ({{ git_is_installed }})  | ternary('git','') }}"
  blockinfile:
    block: |
      plugins=({{ plugins }})
    path: ~/.zshrc
    marker: "# {mark} plugins"
